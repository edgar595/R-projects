"0","application_train %>%"
"0","  group_by(CODE_GENDER) %>%"
"0","  mutate(total_count = n()) %>%  "
"0","  ungroup() %>%"
"0","  group_by(TARGET, CODE_GENDER) %>%"
"0","  summarise(n = n(), total_count = first(total_count), .groups = 'drop') %>%"
"0","  mutate(percentage = n / total_count * 100) %>%"
"0","  ggplot(aes(x = CODE_GENDER, y = percentage, fill = as.factor(TARGET))) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  geom_text(aes(label = sprintf(""%.1f%%"", percentage)), "
"0","            position = position_dodge(width = 1), "
"0","            vjust = -0.5, size = 3) +"
"0","  labs(title = ""Distribution of TARGET by Gender"","
"0","       x = ""Gender"","
"0","       y = ""Percentage"","
"0","       fill = ""TARGET"") +"
"0","  scale_fill_manual(values = c(""0"" = ""blue"", ""1"" = ""red""), labels = c(""0"" = ""Non-default"", ""1"" = ""Default"")) +"
"0","  theme_minimal()"
